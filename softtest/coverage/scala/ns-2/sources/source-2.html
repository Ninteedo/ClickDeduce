


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1252"> 
  <title>Coverage Report > AbstractLanguage</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">languages</a>
</div>

<h1>Coverage Summary for Class: AbstractLanguage (languages)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">AbstractLanguage</td>
<td class="coverageStat">
  <span class="percent">
    28.6%
  </span>
  <span class="absValue">
    (6/21)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    31.8%
  </span>
  <span class="absValue">
    (7/22)
  </span>
</td>
</tr>
  <tr>
    <td class="name">AbstractLanguage$$anon$1</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    40%
  </span>
  <span class="absValue">
    (4/10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$$anon$2</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$DisplayMode</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$DisplayMode$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    33.3%
  </span>
  <span class="absValue">
    (8/24)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (8/8)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$EvalError</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (4/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    30.6%
  </span>
  <span class="absValue">
    (19/62)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (5/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$EvalException</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    4.5%
  </span>
  <span class="absValue">
    (1/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$EvalException$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$Expr</td>
<td class="coverageStat">
  <span class="percent">
    92.9%
  </span>
  <span class="absValue">
    (13/14)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    20.5%
  </span>
  <span class="absValue">
    (9/44)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    85%
  </span>
  <span class="absValue">
    (17/20)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$ExprPlaceholder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    22.7%
  </span>
  <span class="absValue">
    (5/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$ExprPlaceholder$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$Literal</td>
<td class="coverageStat">
  <span class="percent">
    75%
  </span>
  <span class="absValue">
    (3/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    19%
  </span>
  <span class="absValue">
    (8/42)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    75%
  </span>
  <span class="absValue">
    (3/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$Literal$</td>
<td class="coverageStat">
  <span class="percent">
    66.7%
  </span>
  <span class="absValue">
    (2/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    92.9%
  </span>
  <span class="absValue">
    (13/14)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    91.7%
  </span>
  <span class="absValue">
    (11/12)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralAny</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    35.7%
  </span>
  <span class="absValue">
    (15/42)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralAny$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralBool</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    35%
  </span>
  <span class="absValue">
    (7/20)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralBool$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralIdentifier</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    38.1%
  </span>
  <span class="absValue">
    (16/42)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralIdentifier$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralInt</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    36.4%
  </span>
  <span class="absValue">
    (8/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralInt$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralString</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    35.7%
  </span>
  <span class="absValue">
    (15/42)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$LiteralString$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$MissingExpr</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$MissingExpr$</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$Term</td>
<td class="coverageStat">
  <span class="percent">
    57.1%
  </span>
  <span class="absValue">
    (4/7)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    57.1%
  </span>
  <span class="absValue">
    (4/7)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$TermError</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$Type</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (4/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    32.3%
  </span>
  <span class="absValue">
    (20/62)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (5/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$TypeError</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (5/5)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    30.6%
  </span>
  <span class="absValue">
    (19/62)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (11/11)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$TypeException</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    4.5%
  </span>
  <span class="absValue">
    (1/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$TypeException$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$TypePlaceholder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    4.5%
  </span>
  <span class="absValue">
    (1/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$TypePlaceholder$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$UnexpectedExpr</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    4.5%
  </span>
  <span class="absValue">
    (1/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$UnexpectedExpr$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$UnexpectedExprType</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    4.5%
  </span>
  <span class="absValue">
    (1/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$UnexpectedExprType$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$UnknownType</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    10%
  </span>
  <span class="absValue">
    (1/10)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$UnknownType$</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (1/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractLanguage$Value</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (5/5)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    32.3%
  </span>
  <span class="absValue">
    (20/62)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (6/6)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    77.2%
  </span>
  <span class="absValue">
    (78/101)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    28.1%
  </span>
  <span class="absValue">
    (206/732)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    82%
  </span>
  <span class="absValue">
    (114/139)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package languages
&nbsp;
&nbsp;import scalatags.Text.TypedTag
&nbsp;import scalatags.Text.all.*
&nbsp;
&nbsp;import scala.collection.immutable.List
&nbsp;
<b class="fc">&nbsp;trait AbstractLanguage {</b>
&nbsp;
&nbsp;  /** A variable name.
&nbsp;    *
&nbsp;    * Case sensitive.
&nbsp;    */
&nbsp;  type Variable = String
&nbsp;
&nbsp;  /** The evaluation environment at a particular point.
&nbsp;    *
&nbsp;    * Contains variables with bound values.
&nbsp;    */
&nbsp;  type Env = Map[Variable, Value]
&nbsp;
&nbsp;  /** The type environment at a particular point.
&nbsp;    *
&nbsp;    * Contains variables with bound types.
&nbsp;    */
&nbsp;  type TypeEnv = Map[Variable, Type]
&nbsp;
<b class="fc">&nbsp;  trait Term {</b>
<b class="fc">&nbsp;    lazy val toHtml: TypedTag[String] = span(raw(prettyPrint))</b>
&nbsp;
<b class="nc">&nbsp;    def getChildrenBase(env: Env = Map()): List[(Term, Env)] = Nil</b>
&nbsp;
<b class="nc">&nbsp;    def getChildrenEval(env: Env = Map()): List[(Term, Env)] = Nil</b>
&nbsp;
<b class="fc">&nbsp;    def getChildrenTypeCheck(tEnv: TypeEnv = Map()): List[(Term, TypeEnv)] = Nil</b>
&nbsp;
<b class="fc">&nbsp;    def isPlaceholder: Boolean = false</b>
&nbsp;
<b class="nc">&nbsp;    def prettyPrint: String = toHtml.toString</b>
&nbsp;  }
&nbsp;
&nbsp;  /** An unevaluated expression.
&nbsp;    */
<b class="pc">&nbsp;  abstract class Expr extends Term {</b>
&nbsp;    private def getExprFields(e: Expr): List[Expr] = {
<b class="fc">&nbsp;      e match {</b>
<b class="pc">&nbsp;        case e0: Product =&gt;</b>
<b class="fc">&nbsp;          val values = e0.productIterator.toList</b>
<b class="pc">&nbsp;          values.collect({ case e: Expr =&gt; e })</b>
<b class="nc">&nbsp;        case _ =&gt; Nil</b>
&nbsp;      }
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    override def getChildrenBase(env: Env = Map()): List[(Term, Env)] =</b>
<b class="fc">&nbsp;      getExprFields(this).zip(LazyList.continually(env))</b>
&nbsp;
<b class="fc">&nbsp;    override def getChildrenEval(env: Env = Map()): List[(Term, Env)] =</b>
<b class="fc">&nbsp;      getExprFields(this).zip(LazyList.continually(env))</b>
&nbsp;
&nbsp;    override def getChildrenTypeCheck(tEnv: TypeEnv): List[(Term, TypeEnv)] =
<b class="fc">&nbsp;      getExprFields(this).zip(LazyList.continually(tEnv))</b>
&nbsp;
<b class="nc">&nbsp;    lazy val childVersion: Expr = this</b>
&nbsp;
&nbsp;    /** Function which evaluates this `Expr` to a `Value`, given an environment.
&nbsp;      *
&nbsp;      * @param env
&nbsp;      *   The environment to evaluate in.
&nbsp;      * @return
&nbsp;      *   The `Value` resulting from evaluating this.
&nbsp;      */
<b class="fc">&nbsp;    final def eval(env: Env = Map()): Value = {</b>
&nbsp;      try {
<b class="fc">&nbsp;        evalInner(env)</b>
&nbsp;      } catch {
<b class="fc">&nbsp;        case e: StackOverflowError =&gt; stackOverflowEvalError</b>
&nbsp;      }
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    protected def evalInner(env: Env): Value = UnexpectedExpr(toString)</b>
&nbsp;
&nbsp;    /** Function to perform type checking on this `Expr` in the given type environment.
&nbsp;      *
&nbsp;      * @param tEnv
&nbsp;      *   The type environment in which type checking is done.
&nbsp;      * @return
&nbsp;      *   The `Type` of this expression after type checking.
&nbsp;      */
<b class="fc">&nbsp;    final def typeCheck(tEnv: TypeEnv = Map()): Type = {</b>
&nbsp;      try {
<b class="fc">&nbsp;        typeCheckInner(tEnv)</b>
&nbsp;      } catch {
<b class="nc">&nbsp;        case e: StackOverflowError =&gt; stackOverflowTypeError</b>
&nbsp;      }
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    protected def typeCheckInner(tEnv: TypeEnv): Type = UnexpectedExprType(toString)</b>
&nbsp;  }
&nbsp;
<b class="nc">&nbsp;  case class MissingExpr() extends Expr</b>
&nbsp;
<b class="pc">&nbsp;  case class ExprPlaceholder(content: String) extends Expr {</b>
<b class="pc">&nbsp;    override def prettyPrint: String = content</b>
&nbsp;  }
&nbsp;
&nbsp;  /** A value resulting from an expression being evaluated.
&nbsp;    */
<b class="pc">&nbsp;  abstract class Value extends Term {</b>
&nbsp;    override lazy val toHtml: TypedTag[String] =
<b class="pc">&nbsp;      span(cls := &quot;tooltip&quot;, valueText(display := &quot;inline&quot;), div(cls := &quot;tooltip-text&quot;, tooltipText))</b>
&nbsp;
<b class="pc">&nbsp;    lazy val tooltipText: String = toString + &quot;: &quot; + typ.toString</b>
&nbsp;
<b class="pc">&nbsp;    lazy val valueText: TypedTag[String] = div(prettyPrint + &quot;: &quot; + typ.prettyPrint)</b>
&nbsp;
&nbsp;    val typ: Type
&nbsp;
<b class="fc">&nbsp;    val isError: Boolean = false</b>
&nbsp;
<b class="fc">&nbsp;    override def prettyPrint: String = toHtml.toString</b>
&nbsp;  }
&nbsp;
&nbsp;  /** The type of a value.
&nbsp;    */
<b class="pc">&nbsp;  abstract class Type extends Term {</b>
&nbsp;    override lazy val toHtml: TypedTag[String] =
<b class="pc">&nbsp;      span(cls := &quot;tooltip&quot;, valueText(display := &quot;inline&quot;), div(cls := &quot;tooltip-text&quot;, tooltipText))</b>
&nbsp;
<b class="pc">&nbsp;    lazy val tooltipText: String = toString</b>
&nbsp;
<b class="pc">&nbsp;    lazy val valueText: TypedTag[String] = div(prettyPrint)</b>
&nbsp;
<b class="fc">&nbsp;    val isError: Boolean = false</b>
&nbsp;  }
&nbsp;
<b class="pc">&nbsp;  case class UnknownType() extends Type {</b>
<b class="fc">&nbsp;    override def prettyPrint: String = &quot;Unknown&quot;</b>
&nbsp;  }
&nbsp;
<b class="pc">&nbsp;  case class TypePlaceholder(content: String) extends Type {</b>
<b class="pc">&nbsp;    override def prettyPrint: String = content</b>
&nbsp;  }
&nbsp;
&nbsp;  trait TermError extends Term {
<b class="fc">&nbsp;    val message: String = &quot;Error&quot;</b>
&nbsp;  }
&nbsp;
&nbsp;  /** An error resulting from an expression being evaluated.
&nbsp;    */
<b class="pc">&nbsp;  abstract class EvalError extends Value, TermError {</b>
&nbsp;    override lazy val toHtml: TypedTag[String] =
<b class="pc">&nbsp;      span(cls := &quot;tooltip&quot;, valueText, div(cls := &quot;tooltip-text&quot;, tooltipText), cls := &quot;error-origin&quot;)</b>
&nbsp;
<b class="pc">&nbsp;    override lazy val tooltipText: String = message</b>
&nbsp;
<b class="pc">&nbsp;    override lazy val valueText: TypedTag[String] = div(&quot;?&quot;)</b>
&nbsp;
<b class="fc">&nbsp;    override val isError: Boolean = true</b>
&nbsp;  }
&nbsp;
&nbsp;  /** An error that occurs due to attempting to process an unknown `Expr`.
&nbsp;    *
&nbsp;    * @param message
&nbsp;    *   The error message.
&nbsp;    */
<b class="pc">&nbsp;  case class UnexpectedExpr(override val message: String) extends EvalError {</b>
<b class="pc">&nbsp;    override val typ: Type = UnexpectedExprType(message)</b>
&nbsp;  }
&nbsp;
<b class="pc">&nbsp;  case class EvalException(override val message: String) extends EvalError {</b>
<b class="pc">&nbsp;    override val typ: Type = TypeException(message)</b>
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  private val stackOverflowEvalError: EvalError = EvalException(&quot;Stack overflow&quot;)</b>
<b class="fc">&nbsp;  private val stackOverflowTypeError: TypeError = TypeException(&quot;Stack overflow&quot;)</b>
&nbsp;
&nbsp;  /** An error resulting from an expression being type checked.
&nbsp;    */
<b class="pc">&nbsp;  abstract class TypeError extends Type, TermError {</b>
<b class="pc">&nbsp;    override lazy val toHtml: TypedTag[String] = span(</b>
<b class="fc">&nbsp;      cls := &quot;tooltip&quot;,</b>
<b class="fc">&nbsp;      valueText(display := &quot;inline&quot;),</b>
<b class="fc">&nbsp;      div(cls := &quot;tooltip-text&quot;, tooltipText),</b>
<b class="fc">&nbsp;      cls := &quot;error-origin&quot;</b>
<b class="pc">&nbsp;    )</b>
&nbsp;
<b class="pc">&nbsp;    override lazy val tooltipText: String = message</b>
&nbsp;
<b class="pc">&nbsp;    override lazy val valueText: TypedTag[String] = div(&quot;?&quot;)</b>
&nbsp;
<b class="fc">&nbsp;    override val isError: Boolean = true</b>
&nbsp;
<b class="fc">&nbsp;    override def prettyPrint: String = message</b>
&nbsp;  }
&nbsp;
&nbsp;  /** An error that occurs due to attempting to process an unknown `Expr`.
&nbsp;    *
&nbsp;    * @param message
&nbsp;    *   The error message.
&nbsp;    */
<b class="pc">&nbsp;  case class UnexpectedExprType(override val message: String) extends TypeError</b>
&nbsp;
<b class="pc">&nbsp;  case class TypeException(override val message: String) extends TypeError</b>
&nbsp;
<b class="pc">&nbsp;  abstract class Literal extends Term {</b>
&nbsp;    val value: Any
&nbsp;
<b class="nc">&nbsp;    override lazy val toHtml: TypedTag[String] = p(value.toString)</b>
&nbsp;
<b class="pc">&nbsp;    override lazy val toString: String = value.toString</b>
&nbsp;
<b class="fc">&nbsp;    override def prettyPrint: String = toString</b>
&nbsp;  }
&nbsp;
<b class="pc">&nbsp;  object Literal {</b>
<b class="fc">&nbsp;    def fromString(s: String): Literal = {</b>
<b class="fc">&nbsp;      if (List(&quot;true&quot;, &quot;false&quot;).contains(s.toLowerCase)) {</b>
<b class="fc">&nbsp;        LiteralBool(s.toBoolean)</b>
<b class="fc">&nbsp;      } else if (s.startsWith(&quot;\&quot;&quot;) &amp;&amp; s.endsWith(&quot;\&quot;&quot;) &amp;&amp; s.length &gt; 1) {</b>
<b class="fc">&nbsp;        LiteralString(s.substring(1, s.length - 1))</b>
<b class="fc">&nbsp;      } else if (&quot;-?\\d+&quot;.r.matches(s)) {</b>
<b class="fc">&nbsp;        LiteralInt(BigInt(s))</b>
<b class="fc">&nbsp;      } else if (&quot;[A-Za-z_$][\\w_$]*&quot;.r.matches(s)) {</b>
<b class="fc">&nbsp;        LiteralIdentifier(s)</b>
&nbsp;      } else {
<b class="fc">&nbsp;        LiteralAny(s)</b>
&nbsp;      }
<b class="nc">&nbsp;    }</b>
&nbsp;  }
&nbsp;
<b class="pc">&nbsp;  case class LiteralInt(value: BigInt) extends Literal</b>
&nbsp;
<b class="pc">&nbsp;  case class LiteralBool(value: Boolean) extends Literal</b>
&nbsp;
<b class="pc">&nbsp;  case class LiteralString(value: String) extends Literal {</b>
&nbsp;    //    override lazy val toHtml: TypedTag[String] = p(s&quot;&quot;&quot;&quot;$value&quot;&quot;&quot;&quot;)
&nbsp;
<b class="pc">&nbsp;    override lazy val toString: String = s&quot;&quot;&quot;&quot;$value&quot;&quot;&quot;&quot;</b>
&nbsp;  }
&nbsp;
<b class="pc">&nbsp;  case class LiteralIdentifier(value: String) extends Literal {</b>
<b class="pc">&nbsp;    override lazy val toString: String = value</b>
&nbsp;  }
&nbsp;
<b class="pc">&nbsp;  case class LiteralAny(value: String) extends Literal {</b>
<b class="pc">&nbsp;    override lazy val toString: String = value</b>
&nbsp;  }
&nbsp;
<b class="fc">&nbsp;  def envToTypeEnv(env: Env): TypeEnv = env.map((k: String, v: Value) =&gt; (k, v.typ))</b>
&nbsp;
<b class="pc">&nbsp;  enum DisplayMode:</b>
<b class="pc">&nbsp;    case Edit, Evaluation, TypeCheck</b>
&nbsp;
<b class="pc">&nbsp;  object DisplayMode {</b>
<b class="fc">&nbsp;    def fromString(s: String): DisplayMode = s match {</b>
<b class="pc">&nbsp;      case &quot;edit&quot;       =&gt; Edit</b>
<b class="fc">&nbsp;      case &quot;eval&quot;       =&gt; Evaluation</b>
<b class="fc">&nbsp;      case &quot;type-check&quot; =&gt; TypeCheck</b>
<b class="fc">&nbsp;      case _            =&gt; throw new IllegalArgumentException(s&quot;Unknown display mode: $s&quot;)</b>
<b class="fc">&nbsp;    }</b>
&nbsp;  }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-01-22 16:28</div>
</div>
</body>
</html>
